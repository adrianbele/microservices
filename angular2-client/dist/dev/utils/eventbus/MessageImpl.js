/**
 * Created by tvalentijn on 7/2/15.
 */
var Subscription_1 = require("utils/eventbus/Subscription");
var MessageImpl = (function () {
    function MessageImpl(message) {
        this.message = message;
        this._subscriptions = [];
        this._nextId = 0;
        console.log("MessageImpl.constructor for [" + message + "]");
    }
    MessageImpl.prototype.subscribe = function (callback) {
        var subscription = new Subscription_1.Subscription(this._nextId++, callback);
        this._subscriptions[subscription.id] = subscription;
        return subscription.id;
    };
    MessageImpl.prototype.unSubscribe = function (id) {
        this._subscriptions[id] = undefined;
    };
    MessageImpl.prototype.notify = function (payload) {
        var index;
        for (index = 0; index < this._subscriptions.length; index++) {
            if (this._subscriptions[index]) {
                this._subscriptions[index].callback(payload);
            }
        }
    };
    return MessageImpl;
})();
exports.MessageImpl = MessageImpl;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzL2V2ZW50YnVzL01lc3NhZ2VJbXBsLnRzIl0sIm5hbWVzIjpbIk1lc3NhZ2VJbXBsIiwiTWVzc2FnZUltcGwuY29uc3RydWN0b3IiLCJNZXNzYWdlSW1wbC5zdWJzY3JpYmUiLCJNZXNzYWdlSW1wbC51blN1YnNjcmliZSIsIk1lc3NhZ2VJbXBsLm5vdGlmeSJdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFHSCw2QkFBMkIsNkJBQTZCLENBQUMsQ0FBQTtBQUV6RDtJQUtJQSxxQkFBbUJBLE9BQWVBO1FBQWZDLFlBQU9BLEdBQVBBLE9BQU9BLENBQVFBO1FBSDFCQSxtQkFBY0EsR0FBbUJBLEVBQUVBLENBQUNBO1FBQ3BDQSxZQUFPQSxHQUFXQSxDQUFDQSxDQUFDQTtRQUd4QkEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsK0JBQStCQSxHQUFHQSxPQUFPQSxHQUFHQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUNqRUEsQ0FBQ0E7SUFFTUQsK0JBQVNBLEdBQWhCQSxVQUFpQkEsUUFBaUNBO1FBQzlDRSxJQUFJQSxZQUFZQSxHQUFHQSxJQUFJQSwyQkFBWUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsRUFBRUEsRUFBRUEsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDOURBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFlBQVlBLENBQUNBO1FBQ3BEQSxNQUFNQSxDQUFDQSxZQUFZQSxDQUFDQSxFQUFFQSxDQUFDQTtJQUMzQkEsQ0FBQ0E7SUFFTUYsaUNBQVdBLEdBQWxCQSxVQUFtQkEsRUFBVUE7UUFDekJHLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBO0lBQ3hDQSxDQUFDQTtJQUVNSCw0QkFBTUEsR0FBYkEsVUFBY0EsT0FBYUE7UUFDdkJJLElBQUlBLEtBQUtBLENBQUNBO1FBQ1ZBLEdBQUdBLENBQUNBLENBQUNBLEtBQUtBLEdBQUdBLENBQUNBLEVBQUVBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLE1BQU1BLEVBQUVBLEtBQUtBLEVBQUVBLEVBQUVBLENBQUNBO1lBQzFEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDN0JBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLFFBQVFBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1lBQ2pEQSxDQUFDQTtRQUNMQSxDQUFDQTtJQUNMQSxDQUFDQTtJQUNMSixrQkFBQ0E7QUFBREEsQ0EzQkEsSUEyQkM7QUEzQlksbUJBQVcsY0EyQnZCLENBQUEiLCJmaWxlIjoidXRpbHMvZXZlbnRidXMvTWVzc2FnZUltcGwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgdHZhbGVudGlqbiBvbiA3LzIvMTUuXG4gKi9cblxuaW1wb3J0IHtNZXNzYWdlfSBmcm9tIFwiTWVzc2FnZVwiO1xuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gXCJ1dGlscy9ldmVudGJ1cy9TdWJzY3JpcHRpb25cIjtcblxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VJbXBsIGltcGxlbWVudHMgTWVzc2FnZSB7XG5cbiAgICBwcml2YXRlIF9zdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xuICAgIHByaXZhdGUgX25leHRJZDogbnVtYmVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJNZXNzYWdlSW1wbC5jb25zdHJ1Y3RvciBmb3IgW1wiICsgbWVzc2FnZSArIFwiXVwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3Vic2NyaWJlKGNhbGxiYWNrOiAocGF5bG9hZD86IGFueSkgPT4gdm9pZCkge1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzLl9uZXh0SWQrKywgY2FsbGJhY2spO1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zW3N1YnNjcmlwdGlvbi5pZF0gPSBzdWJzY3JpcHRpb247XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb24uaWQ7XG4gICAgfVxuXG4gICAgcHVibGljIHVuU3Vic2NyaWJlKGlkOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9uc1tpZF0gPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcHVibGljIG5vdGlmeShwYXlsb2FkPzogYW55KSB7XG4gICAgICAgIHZhciBpbmRleDtcbiAgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5fc3Vic2NyaXB0aW9ucy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdWJzY3JpcHRpb25zW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnNbaW5kZXhdLmNhbGxiYWNrKHBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9